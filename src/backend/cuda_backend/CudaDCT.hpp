#pragma once
#include <cstdint>
#include <cmath>
#include <cuda_runtime.h>
#include "../tables.hpp"


__constant__ float dctMat[8][8] = {
    {0.353553390593274,	0.353553390593274,	0.353553390593274,	0.353553390593274,	0.353553390593274,	0.353553390593274,	0.353553390593274,	0.353553390593274},
    {0.490392640201615,	0.415734806151273,	0.277785116509801,	0.097545161008064,	-0.097545161008064,	-0.277785116509801,	-0.415734806151273,	-0.490392640201615},
    {0.461939766255643,	0.191341716182545,	-0.191341716182545,	-0.461939766255643,	-0.461939766255643,	-0.191341716182545,	0.191341716182545,	0.461939766255643},
    {0.415734806151273,	-0.097545161008064,	-0.490392640201615,	-0.277785116509801,	0.277785116509801,	0.490392640201615,	0.097545161008064,	-0.415734806151272},
    {0.353553390593274,	-0.353553390593274,	-0.353553390593274,	0.353553390593274,	0.353553390593274,	-0.353553390593273,	-0.353553390593274,	0.353553390593273},
    {0.277785116509801,	-0.490392640201615,	0.097545161008064,	0.415734806151273,	-0.415734806151273,	-0.097545161008065,	0.490392640201615,	-0.277785116509801},
    {0.191341716182545,	-0.461939766255643,	0.461939766255643,	-0.191341716182545,	-0.191341716182545,	0.461939766255644,	-0.461939766255644,	0.191341716182543},
    {0.097545161008064,	-0.277785116509801,	0.415734806151273,	-0.490392640201615,	0.490392640201615,	-0.415734806151272,	0.277785116509802,	-0.097545161008063}
};     
__constant__ float dctMatT[8][8];    // transpose, for columns
      
extern __constant__ const uint8_t d_quant_table[64];
extern __constant__ const uint8_t d_zigzag[64];

__global__ void CudaDCTAndQuantize(uint8_t* input, int16_t* output, int width, int height);